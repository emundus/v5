AdminPackage=new Class({Extends:Canvas,initialize:function(a){this.simpleUI();return},simpleUI:function(){var c=document.id("list-pick");var d=document.id("blockslist");var b=document.id("add-list");var a=document.id("remove-list");this._swaplistIni(b,a,c,d);c=document.id("form-pick");d=document.id("blocksform");b=document.id("add-form");a=document.id("remove-form");this._swaplistIni(b,a,c,d)},_swaplistIni:function(c,a,b,d){c.addEvent("click",function(f){f.stop();this._swaplist(b,d)}.bind(this));a.addEvent("click",function(f){f.stop();this._swaplist(d,b)}.bind(this))},_swaplist:function(b,c){var a=b.getElements("option").filter(function(d){return d.selected});a.each(function(d){d.clone().inject(c);d.destroy()})},makeBlockMenu:function(){var a=new Element("ul",{id:"typeList"}).adopt([new Element("li",{"class":"draggable typeList-list"}).adopt([new Element("img",{src:"components/com_fabrik/images/header/fabrik-list.png",title:"Drag this list icon onto a page"}),new Element("div").set("text","List")]).store("type","list"),new Element("li",{"class":"draggable typeList-form"}).adopt([new Element("img",{src:"components/com_fabrik/images/header/fabrik-form.png",title:"Drag this form icon onto a page"}),new Element("div").set("text","Form")]).store("type","form"),new Element("li",{"class":"draggable typeList-visualization"}).adopt([new Element("img",{src:"components/com_fabrik/images/header/fabrik-visualization.png",title:"Drag this visualization icon onto a page"}),new Element("div").set("text","Visualization")]).store("type","visualization")]);a.inject(document.id("packagemenu"),"before")},insertPage:function(i,d,m,k,a){var o,f;if(a.width===0){a.width=50}if(a.height===0){a.height=50}a["z-index"]=100;var j=new Element("div",{id:d,"class":"fabrikWindow itemPlaceHolder itemPlaceHolder-"+k}).setStyles(a);if(i.editable){var l=function(c){i.removeItem(c,i,d)}.bind(this);f=this.iconGen.create(icon.cross);var n={href:"#","class":"close",events:{click:l}};o=new Element("a",n);f.inject(o)}else{o=null}m=new Element("span",{"class":"handlelabel"}).set("text",m);var g=new Element("div",{"class":"handle"}).adopt([m,o]);var b=new Element("div",{"class":"dragger"});var h=new Element("div",{"class":"itemContent"});var e=d.split("_")[1];h.adopt(new Element("iframe",{width:"100%",height:"90%",src:"index.php?option=com_fabrik&task=package.listform&iframe=1&tmpl=component&id="+e}));j.adopt([g,h,b]);if(i.editable){j.makeResizable({handle:b,onComplete:function(){Fabrik.fireEvent("fabrik.item.resized",j)}});j.makeDraggable({handle:g,container:document.id("packagepages")})}j.addEvent("mousedown",function(c){Fabrik.fireEvent("fabrik.page.add",[j])});i.page.adopt(j)},openListWindow:function(b){this.activeType=b;var c="typeWindow-"+b;if(this.selectWindows[c]){this.selectWindows[c].open()}else{var a="index.php?option=com_fabrik&task=package.dolist&format=raw&list="+b+"&selected="+this.blocks[b].join(",");opts={id:c,type:"modal",title:"Select a "+b,contentType:"xhr",loadMethod:"xhr",contentURL:a,width:200,height:250,x:300,minimizable:false,collapsible:true,onClose:function(){delete this.selectWindows[c]}.bind(this)};this.selectWindows[c]=Fabrik.getWindow(opts)}},addItem:function(b){b.stop();var a=b.target.get("text");this.blocks[this.activeType].push(b.target.id);var c=this.activeType+"_"+b.target.id;this.insertLocation.height="200px";this.insertLocation.width="400px";this.pages.getActivePage().insert(c,a,this.activeType,this.insertLocation);this.selectWindows["typeWindow-"+this.activeType].close()},deleteItem:function(a){a=a.split("_");this.blocks[a[0]].erase(a[1])},prepareSave:function(){return}});